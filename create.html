<html>

<head>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" />

  <title>MortgageApp</title>
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48' fill='none'%3E%3Cpath d='M6 6H42L36 24L42 42H6L12 24L6 6Z' fill='%231978e5'/%3E%3C/svg%3E" />

  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>

<body>
  <div class="relative flex size-full min-h-screen flex-col bg-slate-50 group/design-root overflow-x-hidden"
    style='font-family: Inter, "Noto Sans", sans-serif;'>
    <div class="layout-container flex h-full grow flex-col">
      <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#e7edf3] px-10 py-3">
        <div class="flex items-center gap-4 text-[#0e141b]">
          <div class="size-4">
            <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 6H42L36 24L42 42H6L12 24L6 6Z" fill="currentColor"></path>
            </svg>
          </div>
          <h2 class="text-[#0e141b] text-lg font-bold leading-tight tracking-[-0.015em]">MortgageFinder</h2>
        </div>
        <div class="flex flex-1 justify-end gap-8">
          <div class="flex items-center gap-9">
            <a class="text-[#0e141b] text-sm font-medium leading-normal MENU-INICIO" href="index.html">Inicio</a>
            <a class="text-[#0e141b] text-sm font-medium leading-normal MENU-OFERTAS" href="offers.html">Ofertas</a>
            <a class="text-[#0e141b] text-sm font-medium leading-normal MENU-COMPARACION"
              href="comparacion.html">Comparación</a>
          </div>
          <button
            class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-[#e7edf3] text-[#0e141b] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
            <div class="text-[#0e141b]" data-icon="Bell" data-size="20px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor"
                viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z">
                </path>
              </svg>
            </div>
          </button>
          <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC7lBYTQseSWWYBuDZl_uUZqDJgE24QIcgQBvyqViZHYnra4tC22-D8HsWvLyf-YXLCiqaIWec9aGl7csXwhze4iBhtdPi_cvIJrbkfbrfyxKeKSkwxc0WNZEL1pjQhIlQ6isAbTsOU7qcZhdIujpUNy-2d5hnlHEJtbyQGpFwBb1vCQ5619j3i0LfU4yLaFTvy-arKxFJklFrA-qNVwHZsr9ZCgac8E2nhOdOnEhCpu7vdJo2QC6Xdd-zJZEqxmth1QwMrMCk-Iq5a");'>
          </div>
        </div>
      </header>
      <div class="px-40 flex flex-1 justify-center py-5">
        <div class="layout-content-container flex flex-col w-[512px] max-w-[512px] py-5 max-w-[960px] flex-1">
          <div class="flex flex-wrap justify-between gap-3 p-4">
            <p class="text-[#0e141b] tracking-light text-[32px] font-bold leading-tight min-w-72">Crear Nueva Oferta
              Hipotecaria</p>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Importe del Préstamo</p>
              <input placeholder="Introduce el importe del préstamo"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Tasa de Interés (%)</p>
              <input placeholder="Introduce la tasa de interés"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Plazo del Préstamo (Años)</p>
              <input placeholder="Introduce el plazo del préstamo"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Comisión por amortización anticipada
                (10 primeros años) (%)</p>
              <input placeholder="Introduce la comisión por amortización anticipada (10 primeros años)"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Comisión por amortización anticipada
                (resto de años) (%)</p>
              <input placeholder="Introduce la comisión por amortización anticipada (resto de años)"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Nombre del Prestamista</p>
              <input placeholder="Introduce el nombre del prestamista"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Contacto del Prestamista</p>
              <input placeholder="Introduce el contacto del prestamista"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"
                value="" />
            </label>
          </div>
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="text-[#0e141b] text-base font-medium leading-normal pb-2">Comentarios</p>
              <textarea placeholder="Introduce cualquier comentario adicional"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#0e141b] focus:outline-0 focus:ring-0 border border-[#d0dbe7] bg-slate-50 focus:border-[#d0dbe7] h-14 placeholder:text-[#4e7097] p-[15px] text-base font-normal leading-normal"></textarea>
            </label>
          </div>
          <!-- Zona de productos bonificadores dinámicos -->
          <div class="flex flex-col gap-2 px-4 py-3">
            <p class="text-[#0e141b] text-base font-bold leading-normal pb-2">Productos bonificadores</p>
            <div id="bonificadores-lista"></div>
            <button type="button" onclick="agregarBonificador()"
              class="mt-2 flex items-center gap-2 px-3 py-1 bg-[#e7edf3] text-[#0e141b] rounded-lg text-sm font-medium">Añadir
              producto</button>
          </div>
          <div class="flex px-4 py-3 justify-end">
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#1978e5] text-slate-50 text-sm font-bold leading-normal tracking-[0.015em]">
              <span class="truncate">Guardar Oferta</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    // Utilidad para obtener parámetros de la URL
    function getParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }
    // --- Bonificadores dinámicos ---
    function crearBonificador(concepto = '', coste = '', porcentaje = '') {
      const div = document.createElement('div');
      div.className = 'flex gap-2 items-end mb-2';
      div.innerHTML = `
        <input type="text" placeholder="Concepto" value="${concepto}" class="form-input w-40 rounded-lg border border-[#d0dbe7] p-2 text-base" />
        <input type="number" placeholder="Coste anual (€)" value="${coste}" class="form-input w-32 rounded-lg border border-[#d0dbe7] p-2 text-base" />
        <input type="number" placeholder="% bonificación" value="${porcentaje}" class="form-input w-32 rounded-lg border border-[#d0dbe7] p-2 text-base" />
        <button type="button" onclick="this.parentElement.remove()" class="bg-red-200 text-red-800 rounded px-2 py-1 ml-2">Eliminar</button>
      `;
      return div;
    }
    function agregarBonificador(concepto, coste, porcentaje) {
      document.getElementById('bonificadores-lista').appendChild(crearBonificador(concepto, coste, porcentaje));
    }
    // --- Guardar oferta ---
    function guardarOferta(e) {
      e.preventDefault();
      const campos = document.querySelectorAll('.layout-content-container input, .layout-content-container textarea');
      const nuevaOferta = {};
      // Solo los campos principales
      campos.forEach(campo => {
        if (campo.closest('#bonificadores-lista')) return;
        const label = campo.parentElement.querySelector('p')?.innerText;
        if (label) nuevaOferta[label] = campo.value;
      });
      // Bonificadores
      const bonificadores = [];
      document.querySelectorAll('#bonificadores-lista > div').forEach(div => {
        const [concepto, coste, porcentaje] = div.querySelectorAll('input');
        if (concepto.value && coste.value && porcentaje.value) {
          bonificadores.push({
            concepto: concepto.value,
            coste: parseFloat(coste.value),
            porcentaje: parseFloat(porcentaje.value)
          });
        }
      });
      nuevaOferta.bonificadores = bonificadores;
      let ofertas = JSON.parse(localStorage.getItem('ofertas')) || [];
      const editIdx = getParam('edit');
      if (editIdx !== null) {
        ofertas[editIdx] = nuevaOferta;
      } else {
        ofertas.push(nuevaOferta);
      }
      localStorage.setItem('ofertas', JSON.stringify(ofertas));
      alert(editIdx !== null ? '¡Oferta actualizada con éxito!' : '¡Oferta guardada con éxito!');
      window.location.href = 'offers.html';
    }
    window.onload = function () {
      // Modo edición: cargar datos si edit
      const editIdx = getParam('edit');
      if (editIdx !== null) {
        let ofertas = JSON.parse(localStorage.getItem('ofertas')) || [];
        const oferta = ofertas[editIdx];
        if (oferta) {
          // Rellenar campos principales
          document.querySelectorAll('.layout-content-container input, .layout-content-container textarea').forEach(campo => {
            if (campo.closest('#bonificadores-lista')) return;
            const label = campo.parentElement.querySelector('p')?.innerText;
            if (label && oferta[label] !== undefined) campo.value = oferta[label];
          });
          // Limpiar bonificadores actuales
          document.getElementById('bonificadores-lista').innerHTML = '';
          // Añadir bonificadores de la oferta
          (oferta.bonificadores || []).forEach(b => agregarBonificador(b.concepto, b.coste, b.porcentaje));
          // Cambiar texto del botón
          const btn = document.querySelector('button span.truncate');
          if (btn) btn.textContent = 'Guardar cambios';
        }
      }
      // Asignar evento al botón
      const btn = document.querySelector('button span.truncate');
      if (btn) {
        btn.parentElement.parentElement.onsubmit = guardarOferta;
        btn.parentElement.onclick = guardarOferta;
      }
    }
      // Resaltar el menú activo
      (function () {
        const path = window.location.pathname;
        if (path.endsWith('index.html') || path === '/' || path === '') {
          document.querySelector('.MENU-INICIO').style.color = '#1978e5';
          document.querySelector('.MENU-INICIO').style.fontWeight = 'bold';
        } else if (path.endsWith('offers.html')) {
          document.querySelector('.MENU-OFERTAS').style.color = '#1978e5';
          document.querySelector('.MENU-OFERTAS').style.fontWeight = 'bold';
        } else if (path.endsWith('comparacion.html')) {
          document.querySelector('.MENU-COMPARACION').style.color = '#1978e5';
          document.querySelector('.MENU-COMPARACION').style.fontWeight = 'bold';
        }
      })();
  </script>
</body>

</html>